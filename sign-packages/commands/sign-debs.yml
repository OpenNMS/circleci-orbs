---
description: Sign one or more Debian packages.
parameters:
  gpgname:
    description: the name/email or key ID to use when signing
    type: string
  packages:
    description: the Debian packages to sign
    type: string
  type:
    description: the signature type ("origin", "maint", or "archive")
    type: string
    default: origin
steps:
  - run:
      name: Sign Debian Packages
      command: |
        export GNUPGHOME="$HOME/.gnupg"
        echo "$GPG_PASSPHRASE" | base64 --decode > "$HOME/.gpg-passphrase" && chmod 600 "$HOME/.gpg-passphrase"
        for package in << parameters.packages >>; do
          debsigs --sign=<< parameters.type >> --verify -k "<< parameters.gpgname >>" "$package" || break
        done
