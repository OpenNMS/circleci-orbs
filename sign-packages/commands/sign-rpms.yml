---
description: Sign one or more RPM packages.
parameters:
  gnupghome:
    description: the directory to place GnuPG config in
    type: string
    default: "~/.gnupg"
  gpgname:
    description: the name/email or key ID to use when signing
    type: string
  packages:
    description: the RPM packages to sign
    type: string
steps:
  - run:
      name: Sign RPM Packages
      command: |
        export GNUPGHOME="<< parameters.gnupghome >>"
        echo "$GPG_PASSPHRASE" | base64 --decode > "<< parameters.gnupghome >>/.gpg-passphrase" && chmod 600 "<< parameters.gnupghome >>/.gpg-passphrase"
        rpmsign \
          --key-id='<< parameters.gpgname >>' \
          --resign << parameters.packages >>
