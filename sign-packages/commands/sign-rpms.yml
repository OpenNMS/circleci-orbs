---
description: Sign one or more RPM packages.
parameters:
  gnupg_home:
    description: the location for GnuPG files
    type: string
    default: ~/.gnupg
  gnupg_key:
    description: the name/email or key ID to use when signing
    type: string
  packages:
    description: the RPM packages to sign
    type: string
steps:
  - run:
      name: Sign RPM Packages
      command: |
        export GNUPGHOME="$(realpath << parameters.gnupg_home >> || (cd << parameters.gnupg_home >>; pwd -P))"
        rpmsign \
          --define "passphrase_file ${GNUPGHOME}/gpg-passphrase" \
          --key-id='<< parameters.gnupg_key >>' \
          --resign << parameters.packages >>
